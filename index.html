<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Lyrics App</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />

    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css"
    />

    <style>
      :root {
        --brand-gradient: linear-gradient(135deg, #6f42c1, #8e44ad);
        --header: #f9f8f7;
      }

      html {
        font-size: 70.5%;
      }

      body {
        background: #f8f9fa;
        overflow-x: hidden;
      }

      .btn-primary {
        background: var(--brand-gradient);
        border: none;
      }

      header {
        padding: 1rem 0;
      }

      .menu_btn {
        font-size: 2.7rem;
      }

      .brand_logo {
        width: 10rem;
        height: 10rem;
        object-fit: cover;
      }

      .sidenav {
        position: fixed;
        top: 0;
        left: -25rem;
        width: 22rem;
        height: 100%;
        background: #f8f9fe;
        padding: 2rem 0;
        transition: 0.3s;
        z-index: 1000;
        & .brand_logo {
          width: 12rem;
          height: 12rem;
          object-fit: cover;
        }

        & .brand_text {
          font-size: 1.4rem;
        }

        & .nav-items {
          & a {
            text-decoration: none;
            font-size: 1.6rem;
            padding: 1rem 0;
            color: #333;
          }
        }
      }

      .sidenav.active {
        left: 0;
      }
      .overlay {
        position: fixed;
        inset: 0;
        background: rgba(0, 0, 0, 0.4);
        display: none;
        z-index: 999;
      }

      .overlay.show {
        display: block;
      }

      #search {
        font-size: 1.4rem !important;
        border-radius: 1.5rem;
      }

      .output {
        padding: 1rem 0.5rem;
        max-height: 80vh;
        overflow-y: scroll;
      }

      .output::-webkit-scrollbar {
        width: 0;
      }

      .skeleton {
        background: #e9ecef;
        border-radius: 12px;
        padding: 2rem;
        margin-bottom: 12px;
        position: relative;
        overflow: hidden;
      }

      .skeleton::after {
        content: "";
        position: absolute;
        inset: 0;
        transform: translateX(-100%);
        background: linear-gradient(
          90deg,
          transparent,
          rgba(255, 255, 255, 0.6),
          transparent
        );
        animation: shimmer 1.2s infinite;
      }

      @keyframes shimmer {
        100% {
          transform: translateX(100%);
        }
      }

      .skeleton-title {
        height: 18px;
        width: 70%;
        background: #dee2e6;
        border-radius: 6px;
        margin-bottom: 8px;
      }

      .skeleton-text {
        height: 12px;
        width: 40%;
        background: #dee2e6;
        border-radius: 6px;
      }

      /* ===== SONG CARD ===== */
      .song_container {
        position: relative;
        color: #fff;
        border-radius: 12px;
        padding: 1.2rem;
        overflow: hidden;
        margin-bottom: 12px;
        cursor: pointer;
      }

      .song_container::before {
        content: "";
        position: absolute;
        inset: 0;
        background: var(--bg) center/cover no-repeat, rgba(0, 0, 0, 0.2);
        filter: blur(0.2rem);
        transform: scale(1.3);
      }

      .song_container::after {
        content: "";
        position: absolute;
        inset: 0;
        background: linear-gradient(
          180deg,
          rgba(0, 0, 0, 0.2),
          rgba(0, 0, 0, 0.7)
        );
      }

      .song_container .card-body {
        position: relative;
        z-index: 1;
      }

      #bottomPlayer {
        position: fixed;
        bottom: 5%;
        left: 0;
        right: 0;
        background: var(--brand-gradient);
        color: #fff;
        display: none;
        align-items: center;
        padding: 8px 10px;
        width: 85%;
        gap: 2rem;
        z-index: 999;
        overflow-x: hidden;
        border-radius: 2rem;
      }

      .bp-left img {
        width: 40px;
        height: 40px;
        border-radius: 6px;
        object-fit: cover;
      }

      .bp-center {
        flex: 1;
        font-size: 14px;
      }

      #bpTitle {
        font-weight: bold;
      }

      #bpArtist,
      #bpSongId {
        font-size: 12px;
        opacity: 0.8;
      }

      .bp-right button {
        border-radius: 30%;
        border: 1px solid #fff;
        display: inline-block;
        justify-content: center;
        align-items: center;
        background: none;
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.25);

        color: white;
        font-size: 22px;
        margin-right: 2rem;
      }
    </style>
  </head>
  <body>
    <!-----topbar------->
    <header class="container mx-3 py-3">
      <div class="top_bar d-flex justify-content-start align-items-center">
        <i id="openMenu" class="fas fa-bars menu_btn"></i>

        <div class="brand_logo">
          <img class="img-fluid" src="images/brand/logo.png" alt="" />
        </div>
      </div>
    </header>

    <!-- SIDENAV -->
    <nav class="sidenav" id="sidenav">
      <div class="brand_logo d-flex justify-content-around align-items-center">
        <img
          src="images/brand/logo.png"
          class="resp_logo img-fluid"
          alt="Logo"
        />
        <h6 class="brand_text">Lyricx Music Player</h6>
      </div>
      <hr />

      <div
        class="nav-items d-flex justify-content-around align-items-start flex-column mx-2 p-3 gap-3"
      >
        <a href="index.html">Home</a>
        <a href="developer.html">Developer</a>
        <a href="about.html">About</a>
      </div>
    </nav>

    <div class="overlay" id="overlay"></div>

    <!-- SEARCH BAR -->
    <input
      type="text"
      id="search"
      class="form-control mx-auto p-3 w-75"
      placeholder="Search song..."
    />

    <!-- SONG OUTPUT -->
    <div id="output" class="container mt-5 output"></div>

    <!-- Bottom Music Player -->
    <div id="bottomPlayer" class="container">
      <div class="d-flex justify-content-around align-items-center gap-3">
        <div class="bp-left">
          <img id="bpImage" src="images/1.jpg" alt="song" />
        </div>

        <div class="bp-center">
          <div id="bpTitle">Tum hi ho</div>
          <div id="bpArtist">arjit singh</div>
        </div>

        <div class="bp-right">
          <button id="bpPlayPause">
            <i class="fa fa-play fa-fw"></i>
          </button>
        </div>
      </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>

    <script src="api.js"></script>

    <script>
      console.log(lyrics);

      let currentAudio = null;
      $("#openMenu").click(() => {
        $("#sidenav").addClass("active");
        $("#overlay").addClass("show");
      });

      $("#overlay").click(() => {
        $("#sidenav").removeClass("active");
        $("#overlay").removeClass("show");
      });

      const skeletonDisplay = (count) => {
        if (count <= 0) {
          $("#output").html(`<h5 class="text-center"> No data foundðŸ¤§</h5>`);
          return;
        }
        let sk = "";

        for (let i = 0; i < count; i++) {
          sk += `      <div class="skeleton">
        <div class="skeleton-title"></div>
        <div class="skeleton-text"></div>
      </div>
    `;
        }
        $("#output").html(sk);
      };

      const renderSong = (data) => {
        skeletonDisplay(data.length);

        if (data.length <= 0) {
          $("#output").html(`<h5 class="text-center"> No data foundðŸ¤§</h5>`);
          return;
        }

        setTimeout(function () {
          let html = "";

          data.forEach((song) => {
            html += `
          <div class=" card song_container mb-3"  style="--bg:url(${song.image})" onclick="openSong(${song.id})">
          
          <div class="card-body">
            <h5>${song.name}</h5>
                <small>${song.artist}</small>
          </div>
          </div>
          `;
          });

          $("#output").html(html);
        }, 800);
      };

      renderSong(lyrics);

      const search = $("#search");

      search.on("keyup", function () {
        const val = $(this).val().toLowerCase();
        const filtered = lyrics.filter((song) =>
          song.name.toLowerCase().includes(val)
        );

        renderSong(filtered);
      });

      const openSong = (id) => {
        loadSong(id);
      };

      function loadSong(id) {
        const song = lyrics.find((s) => s.id === id);
        if (!song) return;

        if (currentAudio) {
          currentAudio.pause();
          currentAudio.currentTime = 0;
        }

        currentAudio = new Audio(song.audio);
        currentSongId = id;

        currentAudio.play();

        $("#bpPlayPause i").removeClass("fa-play").addClass("fa-pause");

        updateBottomPlayer(song);

        // song end hone par
        currentAudio.onended = () => {
          $("#bpPlayPause i").removeClass("fa-pause").addClass("fa-play");
        };
      }

      function updateBottomPlayer(song) {
        $("#bpImage").attr("src", song.image);
        $("#bpTitle").text(song.name);
        $("#bpArtist").text(song.artist);
        $("#bpSongId").text("Song ID: " + song.id);

        $("#bottomPlayer").show();
      }

      $("#bpPlayPause").click(function () {
        if (!currentAudio) return;

        const icon = $(this).find("i");

        if (currentAudio.paused) {
          currentAudio.play();
          icon.removeClass("fa-play").addClass("fa-pause");
        } else {
          currentAudio.pause();
          icon.removeClass("fa-pause").addClass("fa-play");
        }
      });
    </script>
  </body>
</html>
